---
title: "覆写的可复制的UILabel"
date: 2015-09-22 14:21:00
tag: [VIM]
blog: true
layout: post

---

**.h文件**

```
#import <UIKit/UIKit.h>  
  
@protocol ZYKCopyLabelDelegate <NSObject>  
  
- (void)ZYKCopyLabelDoSomething:(UIGestureRecognizer *)recognizer;  
  
@end  
  
  
@interface ZYKCopyLabel : UILabel  
  
@property (nonatomic) BOOL isCopyable;  
  
@property (nonatomic) BOOL isPreDealDocument;  
  
@property (nonatomic, retain) id <ZYKCopyLabelDelegate> delegate;  
  
@end  
```


**.m文件**
```
#import "ZYKCopyLabel.h"  
  
@implementation ZYKCopyLabel  
  
// 为了能接收到事件（能成为第一响应者）,覆写方法  
-(BOOL)canBecomeFirstResponder  
{  
    return YES;  
}  
  
-(BOOL)canPerformAction:(SEL)action withSender:(id)sender  
{  
    return (action == @selector(copy:));  
}  
  
-(void)copy:(id)sender  
{  
    UIPasteboard *pboard = [UIPasteboard generalPasteboard];  
    pboard.string = self.text;  
}  
  
-(void)attachTapHandler  
{  
    if (!self.isCopyable) {  
        self.userInteractionEnabled = YES;  
        UILongPressGestureRecognizer *longPress = [[UILongPressGestureRecognizer alloc] initWithTarget:self action:@selector(handleLongPress:)];  
        [self addGestureRecognizer:longPress];  
    }  
      
    if (self.isPreDealDocument) {  
        self.userInteractionEnabled = YES;  
        UITapGestureRecognizer *tap = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(handleTap:)];  
        [self addGestureRecognizer:tap];  
    }  
  
}  
  
- (id)initWithFrame:(CGRect)frame  
{  
    self = [super initWithFrame:frame];  
    if (self)  
    {  
        [self attachTapHandler];  
    }  
    return self;  
}  
  
-(void)awakeFromNib  
{  
    [super awakeFromNib];  
    [self attachTapHandler];  
}  
  
-(void)handleLongPress:(UIGestureRecognizer *)recognizer  
{  
    [self becomeFirstResponder];  
    UIMenuItem *copyLink = [[UIMenuItem alloc] initWithTitle:nil action:@selector(copy:)];  
    [[UIMenuController sharedMenuController] setMenuItems:[NSArray arrayWithObjects:copyLink, nil nil]];  
    [[UIMenuController sharedMenuController] setTargetRect:self.frame inView:self.superview];  
    [[UIMenuController sharedMenuController] setMenuVisible:YES animated: YES];  
}   
-(void)handleTap:(UIGestureRecognizer *)recognizer  
{  
    [self.delegate ZYKCopyLabelDoSomething:recognizer];  
}  
```

结束